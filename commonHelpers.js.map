{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/js/loadMore.js","../src/main.js"],"sourcesContent":["\nconst container = document.querySelector('.gallery')\n\nexport function renderImg(hits) {\n\n  const markup = hits\n    .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n      `<li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-img\">\n      </a>\n        <div class=\"text-wrap\">\n          <p class=\"img-text\">Likes <span class=\"img-text-span\">${likes}</span></p>\n          <p class=\"img-text\">Views <span class=\"img-text-span\">${views}</span></p>\n          <p class=\"img-text\">Comments <span class=\"img-text-span\">${comments}</span></p>\n          <p class=\"img-text\">Downloads <span class=\"img-text-span\">${downloads}</span></p>\n        </div>\n    </li>`)\n    .join(\"\")\n\n\n  container.insertAdjacentHTML('beforeend', markup);\n\n}","import axios from 'axios';\n\n\nexport async function searchImg({\n  q = '',\n  page = 1,\n  per_page = 15,\n} = {}) {\n\n\n  const API_KEY = '44806225-40e07737f22f709bd193bb0f7';\n  const URL = `https://pixabay.com/api/?key=${API_KEY}`;\n  const imageType = 'photo';\n  const orientation = 'horizontal';\n  const safeSearch = true;\n\n\n  const axiosItem = await axios.get(`${URL}&image_type=${imageType}&orientation=${orientation}&safesearch=${safeSearch}`,\n    {\n      params: {\n        q,\n        page,\n        per_page\n      }\n    })\n\n  return axiosItem.data;\n}","\nconst hiddenClass = \"is-hidden\";\n\nfunction hide(btnMore) {\n  btnMore.classList.add(hiddenClass)\n}\n\nfunction show(btnMore) {\n  btnMore.classList.remove(hiddenClass)\n\n}\n\nfunction disable(btnMore,) {\n  btnMore.disabled = true;\n  // loadTime.classList.remove(hiddenClass)\n\n}\n\nfunction enable(btnMore,) {\n  btnMore.disabled = false;\n  // loadTime.classList.add(hiddenClass)\n\n}\n\nexport default { hide, show, disable, enable }","import './js/render-functions';\nimport './js/pixabay-api';\nimport SimpleLightbox from \"simplelightbox\";\n\n\nimport iziToast from \"izitoast\";\nimport { searchImg } from './js/pixabay-api';\nimport { renderImg } from './js/render-functions';\n\nimport buttonService from \"./js/loadMore\";\n\n\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: ''\n};\n\n\nconst bottomSpin = document.querySelector('.bottom-spin');\nconst spin = document.querySelector('.loader');\n\nspin.style.opacity = 0;\nbottomSpin.style.opacity = 0;\n\nconst btnMore = document.querySelector('.page-btn');\nbtnMore.addEventListener('click', handleLoadMore);\n\nbuttonService.hide(btnMore);\n\n\n// !HANDLE SEARCH\nconst form = document.querySelector('.form');\nform.addEventListener(\"submit\", handelSearch);\n\nasync function handelSearch(e) {\n  document.querySelector('.gallery').innerHTML = \"\";\n  params.page = 1;\n\n  e.preventDefault();\n  spin.style.opacity = 1;\n\n\n  const formTarget = e.currentTarget;\n  params.q = formTarget.elements.query.value.trim().toLowerCase();\n\n  if (params.q.length <= 0) {\n    iziToast.show({\n      backgroundColor: '#ef4040',\n      messageColor: '#fff',\n      messageSize: '16px',\n      position: 'topRight',\n      message: 'Please write something in the search field'\n    })\n\n    spin.style.opacity = 0;\n    form.reset();\n    return;\n\n  }\n\n  buttonService.show(btnMore);\n  buttonService.disable(btnMore)\n\n  try {\n    const { hits,\n      totalHits } = await searchImg(params)\n    returnImg({ hits })\n\n    params.maxPage = Math.ceil(totalHits / params.per_page);\n\n    if (hits.length > 0 && hits.length !== totalHits) {\n      buttonService.enable(btnMore);\n    } else {\n      buttonService.hide(btnMore)\n    }\n\n  } catch (error) {\n    fetchError(error)\n  } finally {\n    form.reset();\n  }\n}\n\n\n\n// !SIMPLE LIGHTBOX\nlet galleryShow = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\n\n\n// !RETURN IMG\nfunction returnImg({ hits }) {\n\n  if (hits.length === 0) {\n    fetchError()\n  } else {\n    renderImg(hits)\n  }\n\n  galleryShow.on('show.simplelightbox', function () {\n  });\n\n  galleryShow.refresh()\n  spin.style.opacity = '0';\n}\n\n\n// !FETCH ERROR\nfunction fetchError() {\n  iziToast.error({\n    backgroundColor: '#ef4040',\n    messageColor: '#fff',\n    messageSize: '16px',\n    position: 'topRight',\n    message: 'Sorry, there are no images matching your search query. Please try again!'\n  })\n}\n\n\n\n// !HANDLE LOAD MORE\nasync function handleLoadMore() {\n  params.page += 1;\n  buttonService.disable(btnMore);\n  bottomSpin.style.opacity = 1;\n\n  try {\n    const { hits } = await searchImg(params)\n    returnImg({ hits })\n\n    const galleryItems = document.querySelector('.gallery-item');\n    const cardHeight = galleryItems.getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: \"smooth\",\n    });\n    bottomSpin.style.opacity = 0;\n  } catch (error) {\n    fetchError(error)\n  } finally {\n    buttonService.enable(btnMore);\n    if (params.page === params.maxPage) {\n      buttonService.hide(btnMore)\n      btnMore.removeEventListener('click', handleLoadMore)\n      iziToast.info({\n        backgroundColor: '#7453d7',\n        messageColor: '#fff',\n        messageSize: '16px',\n        position: 'bottomCenter',\n        message: \"We're sorry, but you've reached the end of search results.\"\n      })\n    }\n  }\n}"],"names":["container","renderImg","hits","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchImg","q","page","per_page","URL","imageType","orientation","safeSearch","axios","hiddenClass","hide","btnMore","show","disable","enable","buttonService","params","bottomSpin","spin","handleLoadMore","form","handelSearch","formTarget","iziToast","totalHits","returnImg","fetchError","galleryShow","SimpleLightbox","cardHeight"],"mappings":"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"}